import{d as dedent,E as EditorView,a as EditorState,b as basicSetup,j as javascript,V as ViewPlugin}from"./vendor.b8aaaf06.js";const p=function(){const relList=document.createElement("link").relList;if(!(relList&&relList.supports&&relList.supports("modulepreload"))){for(const link of document.querySelectorAll('link[rel="modulepreload"]'))processPreload(link);new MutationObserver((mutations=>{for(const mutation of mutations)if("childList"===mutation.type)for(const node of mutation.addedNodes)"LINK"===node.tagName&&"modulepreload"===node.rel&&processPreload(node)})).observe(document,{childList:!0,subtree:!0})}function processPreload(link){if(link.ep)return;link.ep=!0;const fetchOpts=function(script){const fetchOpts={};return script.integrity&&(fetchOpts.integrity=script.integrity),script.referrerpolicy&&(fetchOpts.referrerPolicy=script.referrerpolicy),"use-credentials"===script.crossorigin?fetchOpts.credentials="include":"anonymous"===script.crossorigin?fetchOpts.credentials="omit":fetchOpts.credentials="same-origin",fetchOpts}(link);fetch(link.href,fetchOpts)}};p();var style="";const VOID_ELEMENTS={area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},TAG_NAMES=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","head","header","hgroup","h1","h2","h3","h4","h5","h6","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","svg","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","u","ul","video","wbr"],KEBAB_REGEX=/[A-Z\u00C0-\u00D6\u00D8-\u00DE]/g,replacer=match=>"-"+match.toLowerCase(),kebabCase=str=>str.replace(KEBAB_REGEX,replacer);function createTag(name,isVoid,opener){return opener="html"===name?"<!DOCTYPE html><html":`<${name}`,function(a0){if(arguments.__IS_ARGUMENTS__=!0,a0&&!a0.__IS_ARGUMENTS__&&"object"==typeof a0&&"function"!=typeof a0.then&&"function"!=typeof a0.on&&!Array.isArray(a0)){let a,str="";for(a in a0)str+=` ${a}="${a0[a]}"`;return str+=">",arguments[0]=str,isVoid?arguments[-1]=opener:(arguments[-1]=opener,arguments[arguments.length]=`</${name}>`,arguments.length+=1),arguments}return isVoid?`<${name}>`:(arguments[-1]=opener+">",arguments[arguments.length]=`</${name}>`,arguments.length+=1,arguments)}}const _$1=TAG_NAMES.reduce(((o,name)=>(o[name]=createTag(name,VOID_ELEMENTS[name]),o)),Object.create(null));function traverse$1(arr,ctx={}){let i,value,queue_a=[arr=Array.isArray(arr)?arr:[arr]],queue_i=[0],dedupes=Object.create(null);return function next(replaceValue){if(void 0!==replaceValue?value=replaceValue:(i=queue_i[0],value=queue_a[0][i],queue_i[0]=i+1,"function"==typeof value&&(value=value(ctx))),value=null!=value&&value,value.__IS_ARGUMENTS__||Array.isArray(value)){if(value.__DEDUPE__){if(dedupes[value.__DEDUPE__])return next();dedupes[value.__DEDUPE__]=!0}return queue_a.unshift(value),queue_i.unshift(value.__IS_ARGUMENTS__?-1:0),next()}if(!1!==value)return"string"==typeof value||"function"==typeof value.then||"function"==typeof value.on?value:String(value);if(queue_i[0]>=queue_a[0].length){if(queue_a.shift(),queue_i.shift(),!queue_a||!queue_a.length)return;return next()}return next()}}function toString(arr,ctx){const next=traverse$1(arr,ctx);let o,frags=[];do{o=next(),frags.push(o)}while(o);return frags.join("")}function toStream$1(res,arr,ctx,errorRender){const next=traverse$1(arr,ctx);function handleError(error){res.off("drain",loop),res.emit("error",error);const errorHtml=toString(errorRender||_$1.div({id:"genz-error"},_$1.style(css$1("#genz-error",{left:"20px",right:"20px",bottom:"20px",padding:"18px",position:"absolute",background:"rgba(255, 100, 100, 0.5)",border:"1px solid red"})),"Oops! Something went very wrong."),error);res.write(errorHtml)?process.nextTick((()=>res.destroy())):res.on("drain",(()=>res.destroy()))}let stream;function readStream(){stream.on("data",(d=>{res.write(d)?stream.read():res.on(drain,readStream)})),stream.read()}async function loop(){try{let frag=next();for(;void 0!==frag&&res.writable;){if(frag.on)return stream=frag,stream.on("end",loop),stream.on("error",handleError),readStream();if(frag.then&&(frag=next(await frag)),!res.write(frag))return;frag=next()}return res.end()}catch(error){handleError(error)}}loop(),res.on("drain",loop)}function dedupe$1(v,id){return v.__DEDUPE__=id,v}function css$1(chunks,a,arg,d){for(chunks=[],a=0;a<arguments.length;a++)if(arg=arguments[a],0===a)chunks.push(`${Array.isArray(arg)?arg.join(","):arg}{`);else for(d in arg)chunks.push(`${kebabCase(d)}:${arg[d]};`);return chunks.push("}"),chunks}function mediaQuery$1(chunks,a,arg){for(chunks=[],a=0;a<arguments.length;a++)arg=arguments[a],0===a?chunks.push(`@media ${arg} {`):chunks.push(arg);return chunks.push("}"),chunks}var genz=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",createTag:createTag,_:_$1,traverse:traverse$1,toString:toString,toStream:toStream$1,dedupe:dedupe$1,css:css$1,mediaQuery:mediaQuery$1});const{_:_,css:css,traverse:traverse,mediaQuery:mediaQuery,dedupe:dedupe,toStream:toStream}=genz;console.log({_:_,css:css,traverse:traverse,mediaQuery:mediaQuery,dedupe:dedupe,toStream:toStream});const editor=document.getElementById("editor"),errors=document.getElementById("errors"),preview=document.getElementById("preview");let initial;try{window.location.hash.length>1&&(initial=window.atob(window.location.hash.slice(1)))}catch(e){}initial=initial||dedent("\n_.html(\n  _.head(\n    _.title('Basic Example'),\n    _.style(css('body', {\n      backgroundColor: 'limegreen'\n    }))\n  ),\n  _.body(\n    _.h1('Hello World'),\n    _.p('This is a basic example.')\n  )\n)\n");const updatePreview=async txt=>{try{const tree=eval(txt),html=await new Promise(((resolve,reject)=>{const chunks=[];toStream({writable:!0,write:c=>(chunks.push(c),!0),end(){resolve(chunks.join(""))},on(){}},tree),errors.classList.remove("show")}));preview.src=`data:text/html;charset=utf-8,${window.escape(html)}`,window.location.hash=btoa(txt)}catch(e){window.location.hash="",errors.classList.add("show"),errors.innerText=e.message}};updatePreview(initial),new EditorView({parent:editor,state:EditorState.create({doc:initial,extensions:[basicSetup,javascript(),ViewPlugin.fromClass(class{constructor(view){}update(update){update.docChanged&&updatePreview(update.state.doc.toString())}})]})});
